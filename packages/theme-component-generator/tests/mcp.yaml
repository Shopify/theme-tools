# yaml-language-server: $schema=https://promptfoo.dev/config-schema.json
description: 'Testing if the MCP server is called correctly'
env:
  ANTHROPIC_BASE_URL: https://proxy.shopify.ai/apis/anthropic
  OPENAI_API_BASE_URL: https://proxy.shopify.ai/v1
  # set ANTHROPIC_API_KEY and OPENAI_API_KEY inside .env file
providers:
  - id: openai:o4-mini
    config:
      mcp:
        enabled: true
        server:
          command: node
          args: ["--experimental-strip-types", "./src/index.ts"]
          name: "Liquid MCP Server"
  - id: anthropic:messages:claude-4-sonnet-20250514
    config:
      mcp:
        enabled: true
        server:
          command: node
          args: ["--experimental-strip-types", "./src/index.ts"]
          name: "Liquid MCP Server"

tests:
  - vars:
      prompt: "Generate me a Liquid accordion component"
    assert:
      # Assert that the MCP server was called by checking for tool usage indicators
      - type: contains
        value: 'generate-liquid-component'
        description: "Should call the generate-liquid-component tool"
  - vars:
      prompt: "Spell the word 'liquid' backwards"
    assert:
      - type: not-contains
        value: 'generate-liquid-component'
        description: "Should not call the generate-liquid-component tool"
